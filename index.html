<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <style>
        #chart {
            max-width: 70%;
            margin: 35px auto;
        }
        .pentionTable{
            border-collapse:collapse;
            width: 80%;
            margin-left:auto;
            margin-right:auto;
        }

        th, td{
            padding: 1%;
            text-align: center;
            border-bottom: 1px solid #ddd;
        }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
</head>

<body>
    <script>
        function monthlyPentionChart(retireAge, deadAge, reqAsset, finAsset, pubPention, perPention, retirePention) {
            var ageRange = deadAge - retireAge + 1; //연령범위
            var reqAsset = reqAsset;  //월 필요금액
            var monthlyFinAsset = Math.round(finAsset / ageRange / 12 / 10000); //월별로 받을 금액들
            var monthlyPubPention = Math.round(pubPention / ageRange / 12 / 10000);
            var monthlyPerPention = Math.round(perPention / ageRange / 12 / 10000);
            var monthlyRetirePention = Math.round(retirePention / ageRange / 12 / 10000);
            var shortAmount = reqAsset - (monthlyFinAsset + monthlyPubPention + monthlyPerPention + monthlyRetirePention);  //월 부족금액
            var options = {
                series: [{
                    name: '현재 납입액',
                    data: [monthlyPubPention, monthlyRetirePention, monthlyPerPention]
                }, {
                    name: '추가 예상적립액',
                    data: [300 - monthlyPubPention, 200 - monthlyRetirePention, 100 - monthlyPerPention],
                    color: '#949494'
                }],
                chart: {
                    type: 'bar',
                    height: 250,
                    stacked: true,
                    stackType: true,
                    toolbar: {
                        show: false,
                    }
                },
                plotOptions: {
                    bar: {
                        horizontal: true,
                    },
                },
                xaxis: {
                    categories: ['공적연금', '퇴직연금', '개인연금'],
                    labels: {
                        formatter: function (val) {
                            return val + "만원"
                        }
                    }
                },
                grid: {
                    show: false,
                },
                legend: {
                    show: false,
                },
                fill: {
                    opacity: 1

                },
                legend: {
                    position: 'top',
                    horizontalAlign: 'left',
                    offsetX: 40
                },
                tooltip: {
                    enabled: false,
                },
                states: {
                    active: {
                        allowMultipleDataPointsSelection: false,
                        filter: {
                            type: 'none',
                            value: 0,
                        }
                    },
                }
            }

            var chart = new ApexCharts(document.querySelector("#chart"), options);
            chart.render();

            document.getElementById('prePention').innerHTML = "<td>예상적립액</td><td>"+(pubPention/100000000).toFixed(2)+"억원</td><td>"+(retirePention/100000000).toFixed(2)+"억원</td><td>"+(perPention/100000000).toFixed(2)+"억원</td>";
            document.getElementById('payPention').innerHTML = "<td>총납입액</td><td>"+(pubPention/100000000).toFixed(2)+"억원</td><td>"+(retirePention/100000000).toFixed(2)+"억원</td><td>"+(perPention/100000000).toFixed(2)+"억원</td>";
        }
    </script>
    <div id="chart"></div>
    <div>
        <table class="pentionTable">
            <tr>
                <th>구분</th>
                <th>국민연금</th>
                <th>퇴직연금</th>
                <th>개인연금</th>
            </tr>
            <tr id="prePention">

            </tr>
            <tr id="payPention">
            </tr>

        </table>

    </div>
    <script>monthlyPentionChart(55, 90, 2700000, 200000000, 429051000, 130485000, 199140000);</script>
</body>

</html>